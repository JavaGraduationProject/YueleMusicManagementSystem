webpackJsonp([1],{"3iv/":function(e,t){},NGJ5:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("Dd8w"),i=s.n(o),a=s("jQzo"),r=s("tSKS"),n=s("NYxO"),l={name:"adminHome",components:{userInfoForm:a.default,passwordForm:r.default},data:function(){return{rootKey:(new Date).getTime(),defaultOpen:[],contextMenuData:{menu:{name:"",href:""},axis:{x:null,y:null},menulists:[{fnHandler:"refresh",icoName:"el-icon-refresh-right",btnName:"刷新页面"},{fnHandler:"delOther",icoName:"el-icon-circle-close",btnName:"关闭其他"},{fnHandler:"delCurrent",icoName:"el-icon-close",btnName:"关闭当前"},{fnHandler:"delRight",icoName:"el-icon-right",btnName:"关闭右侧"},{fnHandler:"closeAll",icoName:"el-icon-circle-close",btnName:"关闭全部"}]},isHidden:!1,isCollapse:!1,editableTabsValue:"/main/index",editableTabs:[{title:"首页",href:"/main/index"}],menuList:[]}},mounted:function(){var e=this;"/main/home"==this.$route.path?this.changeRouter("/main/index"):this.addTab({name:this.$route.meta.title,href:this.$route.path}),this.$request.getMenuUserTree().then(function(t){t.isOk?e.menuList=t.list:e.$router.push("/login")})},computed:{mode:function(){return this.$store.getters.config.isHorizontal?"horizontal":"vertical"},userInfo:function(){return this.$store.getters.userInfo},projectName:function(){return this.$store.getters.config.projectName}},methods:i()({},Object(n.b)(["commitLoginOut","commitUserInfo"]),{showMenu:function(e){event.preventDefault();var t=event.clientX,s=event.clientY;this.contextMenuData.menu={name:e.currentTarget.innerText,href:e.currentTarget.id},this.contextMenuData.axis={x:t,y:s}},refresh:function(){var e=this.contextMenuData.menu.href.split("-")[1];this.editableTabsValue==e&&(this.rootKey=(new Date).getTime()),this.editableTabsValue=e,this.changeRouter(e)},delRight:function(){for(var e=this,t=this.contextMenuData.menu.href.split("-")[1],s=0,o=0;o<this.editableTabs.length;o++)if(this.editableTabs[o].href==t){s=o;break}this.editableTabs.splice(s+1,this.editableTabs.length).forEach(function(t){e.removeTab(t.href)}),this.editableTabsValue=t,this.changeRouter(t)},delOther:function(){var e=this,t=this.contextMenuData.menu.href.split("-")[1];this.editableTabs.filter(function(e){return e.href!=t&&"/main/index"!=e.href}).forEach(function(t){e.removeTab(t.href)})},delCurrent:function(){var e=this.contextMenuData.menu.href.split("-")[1];this.removeTab(e)},closeAll:function(){this.editableTabs=[{title:"首页",href:"/main/index"}],this.changeRouter("/main/index"),this.editableTabsValue="/main/index"},refreshUserInfo:function(){this.commitUserInfo()},openUserInfoDialog:function(e){this.$refs.userInfoDialog.open(e)},openPasswordDialog:function(e){this.$refs.passwordDialog.open(e)},passwordSuccess:function(){var e=this;e.showConfirm("您的密码已修改成功，是否进行重新登录?",function(){e.commitLoginOut().then(function(t){t.isOk&&(e.showToast("退出成功"),e.$router.push("/login"))})})},loginOut:function(){var e=this;e.showConfirm("确认退出吗?",function(){e.commitLoginOut().then(function(t){t.isOk&&(e.showToast("退出成功"),e.$router.push("/login"))})})},collapse:function(){this.isCollapse=!this.isCollapse,this.isCollapse?this.isHidden=!0:this.isHidden=!1},handleOpen:function(e,t){},handleClose:function(e,t){console.log(e,t)},changeRouter:function(e){this.$router.push(e)},changeTab:function(e){var t=e.name;this.$router.push(t)},addTab:function(e){this.editableTabs.map(function(e){return e.href}).contain(e.href)||this.editableTabs.push({title:e.name,href:e.href}),this.editableTabsValue=e.href;var t=this;setTimeout(function(){document.getElementById("tab-"+e.href).oncontextmenu=t.showMenu},500)},removeTab:function(e){var t=this,s=this.editableTabs,o=this.editableTabsValue;o===e&&s.forEach(function(i,a){if(i.href===e){var r=s[a+1]||s[a-1];r&&(o=r.href,t.changeRouter(r.href))}}),this.editableTabsValue=o,this.editableTabs=s.filter(function(t){return t.href!==e})}})},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("userInfo-form",{ref:"userInfoDialog",on:{reload:e.refreshUserInfo}}),e._v(" "),s("password-form",{ref:"passwordDialog",on:{success:e.passwordSuccess}}),e._v(" "),s("el-aside",{staticClass:"el-aside",class:[{"aside-hidden":e.isHidden,"aside-horizontal":"horizontal"==e.mode}]},[s("el-menu",{attrs:{mode:e.mode,"text-color":"#fff","active-text-color":"#409EFF","default-openeds":e.defaultOpen,"default-active":e.$route.path,collapse:e.isCollapse,router:""},on:{open:e.handleOpen,close:e.handleClose}},e._l(e.menuList,function(t,o){return t.children&&!t.href?s("el-submenu",{key:o,attrs:{index:o}},[s("template",{slot:"title"},[s("i",{class:t.icon}),s("span",{staticClass:"span",attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.name))])]),e._v(" "),e._l(t.children,function(t,o){return s("el-menu-item",{key:o,attrs:{index:t.href},on:{click:function(s){return e.addTab(t)}}},[s("span",{staticClass:"span",attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.name))])])})],2):s("el-menu-item",{staticClass:"el-submenu__title",attrs:{index:t.href},on:{click:function(s){return e.addTab(t)}}},[s("i",{class:t.icon}),s("span",{staticClass:"span",attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.name))])])}),1)],1),e._v(" "),s("el-container",{class:[{"body-horizontal":"horizontal"==e.mode}],staticStyle:{height:"100vh"}},[s("el-header",{staticClass:"el-header",class:[{"header-horizontal":"horizontal"==e.mode}]},["horizontal"!=e.mode?s("div",{staticStyle:{float:"left"}},[s("svg",{staticClass:"icon hamburger pointer",class:{"is-active":!e.isHidden},attrs:{t:"1637039383052",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},on:{click:e.collapse}},[s("path",{attrs:{d:"M935.27 12.34H89.78c-41.38 0-75.23 33.85-75.23 75.23S48.4 162.8 89.78 162.8h845.49c41.38 0 75.23-33.85 75.23-75.23 0-41.37-33.85-75.23-75.23-75.23zM935.27 295.17H496.64c-41.38 0-75.23 33.85-75.23 75.23s33.85 75.23 75.23 75.23h438.63c41.38 0 75.23-33.85 75.23-75.23 0-41.37-33.85-75.23-75.23-75.23zM935.27 578.27H496.64c-41.38 0-75.23 33.85-75.23 75.23s33.85 75.23 75.23 75.23h438.63c41.38 0 75.23-33.85 75.23-75.23 0-41.37-33.85-75.23-75.23-75.23zM935.27 861.64H89.78c-41.38 0-75.23 33.85-75.23 75.23s33.85 75.23 75.23 75.23h845.49c41.38 0 75.23-33.85 75.23-75.23 0-41.37-33.85-75.23-75.23-75.23zM26.95 544.85l235.2 176.67c25.2 18.93 61.19 0.95 61.19-30.57V332.96c0-31.74-36.44-49.65-61.57-30.28L26.57 484.01c-20.01 15.42-19.82 45.67 0.38 60.84z",fill:"#ffffff"}})]),e._v(" "),s("span",{staticClass:"project-name"},[e._v(e._s(e.projectName))])]):e._e(),e._v(" "),s("el-dropdown",[s("span",{staticClass:"el-dropdown-link pointer"},[s("el-image",{staticClass:"head-img",attrs:{src:e.formatUrl(e.userInfo.photo)}}),e._v(" "),s("span",{staticStyle:{color:"white","font-weight":"bold","font-size":"medium"}},[e._v(e._s(e.userInfo.loginName))]),e._v(" "),s("i",{staticClass:"el-icon-arrow-down",staticStyle:{color:"white"}})],1),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{nativeOn:{click:function(t){return e.openUserInfoDialog({title:"用户信息",pageFrom:"edit",id:e.userInfo.id})}}},[e._v("用户信息")]),e._v(" "),s("el-dropdown-item",{nativeOn:{click:function(t){return e.openPasswordDialog({title:"修改密码"})}}},[e._v("修改密码")]),e._v(" "),s("el-dropdown-item",{nativeOn:{click:function(t){return e.loginOut.apply(null,arguments)}}},[e._v("退出登录")])],1)],1),e._v(" "),s("el-dropdown",[e._l(e.userInfo.roleList,function(t){return s("span",{staticClass:"pointer",staticStyle:{color:"ghostwhite"}},[e._v("【"+e._s(t.roleName)+"】")])}),e._v(" "),e.userInfo.office?s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",[e._v("所属机构:【"+e._s(e.userInfo.office.name)+"】")])],1):s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{staticStyle:{display:"none"}})],1)],2)],1),e._v(" "),s("vue-context-menu",{staticStyle:{width:"auto"},attrs:{contextMenuData:e.contextMenuData},on:{refresh:e.refresh,delRight:e.delRight,delOther:e.delOther,delCurrent:e.delCurrent,closeAll:e.closeAll}}),e._v(" "),s("el-tabs",{staticClass:"menu-tabs",staticStyle:{background:"white",border:"none"},attrs:{type:"border-card",closable:""},on:{"tab-click":e.changeTab,"tab-remove":e.removeTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,function(e){return s("el-tab-pane",{key:e.name,attrs:{label:e.title,name:e.href}})}),1),e._v(" "),s("el-main",{staticStyle:{background:"white"}},[s("router-view",{key:e.rootKey})],1),e._v(" "),s("el-footer",{staticClass:"copyright"},[e._v("Copyright © "+e._s((new Date).getFullYear())+" by "+e._s(e.projectName))])],1)],1)},staticRenderFns:[]};var u=s("VU/8")(l,d,!1,function(e){s("lTLE")},"data-v-1a2bd5c7",null);t.default=u.exports},Wzlg:function(e,t){},jQzo:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("mvHQ"),i=s.n(o),a=s("Dd8w"),r=s.n(a),n=s("NYxO"),l={data:function(){return{dialog:{title:"",open:!1,disabled:!1},sysUser:{photo:"",loginName:"",userName:"",userNo:"",email:"",phone:"",officeId:""},rules:{photo:[{required:!0,message:"请输入用户头像",trigger:"blur"}],loginName:[{required:!0,message:"请输入登录名",trigger:"blur"}],userName:[{required:!0,message:"请输入姓名",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱",trigger:"blur"},{validator:this.$validator.unique,form:this,model:"sysUser",tableName:"sys_user",column:"email",message:"邮箱已存在",trigger:"blur"}],phone:[{validator:this.$validator.phone,message:"请输入11位手机号",trigger:"blur"},{validator:this.$validator.unique,form:this,model:"sysUser",tableName:"sys_user",column:"phone",message:"手机号已存在",trigger:"blur"}]}}},computed:{userInfo:function(){return this.$store.getters.userInfo}},methods:r()({},Object(n.b)(["commitUpdateUserInfo"]),{open:function(e){var t=JSON.parse(i()(this.userInfo));this.sysUser=t,this.showDialog(e.title,!1)},cancel:function(){this.dialog.open=!1},submitForm:function(){var e=this;e.$refs.sysUserForm.validate(function(t){t&&e.commitUpdateUserInfo(e.sysUser).then(function(t){t.isOk&&(e.dialog.open=!1,e.showSuccess("提交成功"),e.$emit("reload"))})})},showDialog:function(e,t){this.resetForm(this.$refs.sysUserForm),this.dialog.open=!0,this.dialog.title=e,this.dialog.disabled=t}})},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"body"},[s("el-dialog",{attrs:{width:"600px",title:e.dialog.title,"close-on-click-modal":!1,visible:e.dialog.open},on:{"update:visible":function(t){return e.$set(e.dialog,"open",t)}}},[s("el-form",{ref:"sysUserForm",attrs:{model:e.sysUser,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户头像",prop:"loginName"}},[s("sui-photo",{attrs:{type:"user",disabled:e.dialog.disabled,url:e.sysUser.photo},model:{value:e.sysUser.photo,callback:function(t){e.$set(e.sysUser,"photo",t)},expression:"sysUser.photo"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"登录名",prop:"loginName"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{placeholder:"请输入登录名",disabled:e.dialog.disabled},model:{value:e.sysUser.loginName,callback:function(t){e.$set(e.sysUser,"loginName",t)},expression:"sysUser.loginName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"姓名",prop:"userName"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{placeholder:"请输入姓名",disabled:e.dialog.disabled},model:{value:e.sysUser.userName,callback:function(t){e.$set(e.sysUser,"userName",t)},expression:"sysUser.userName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{placeholder:"请输入手机号",disabled:e.dialog.disabled},model:{value:e.sysUser.phone,callback:function(t){e.$set(e.sysUser,"phone",t)},expression:"sysUser.phone"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{placeholder:"请输入邮箱",disabled:e.dialog.disabled},model:{value:e.sysUser.email,callback:function(t){e.$set(e.sysUser,"email",t)},expression:"sysUser.email"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),e.dialog.disabled?e._e():s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(l,d,!1,function(e){s("Wzlg")},"data-v-ea22ecc8",null);t.default=u.exports},lTLE:function(e,t){},tSKS:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"body"},[s("el-dialog",{attrs:{width:"600px",title:e.dialog.title,"close-on-click-modal":!1,visible:e.dialog.open},on:{"update:visible":function(t){return e.$set(e.dialog,"open",t)}}},[s("el-form",{ref:"passwordForm",attrs:{model:e.user,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"登录名",prop:"loginName"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{disabled:"",placeholder:"请输入登录名"},model:{value:e.user.loginName,callback:function(t){e.$set(e.user,"loginName",t)},expression:"user.loginName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"原始密码",prop:"oldPassword"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{type:"password",placeholder:"请输入原始密码",disabled:e.dialog.disabled},model:{value:e.user.oldPassword,callback:function(t){e.$set(e.user,"oldPassword",t)},expression:"user.oldPassword"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{type:"password",placeholder:"请输入新密码",disabled:e.dialog.disabled},model:{value:e.user.newPassword,callback:function(t){e.$set(e.user,"newPassword",t)},expression:"user.newPassword"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"确认密码",prop:"prePassword"}},[s("el-input",{staticStyle:{width:"217px"},attrs:{type:"password",placeholder:"请输入确认密码",disabled:e.dialog.disabled},model:{value:e.user.prePassword,callback:function(t){e.$set(e.user,"prePassword",t)},expression:"user.prePassword"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),e.dialog.disabled?e._e():s("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var i=s("VU/8")({data:function(){return{roleList:[],checkRoleList:["普通用户"],dialog:{title:"",open:!1,disabled:!1},user:{loginName:this.$store.getters.userInfo.loginName,oldPassword:"",newPassword:"",prePassword:""},rules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],prePassword:[{required:!0,message:"请输入确认密码",trigger:"blur"}]}}},mounted:function(){},methods:{open:function(e){this.showDialog(e.title,!1)},cancel:function(){this.dialog.open=!1},submitForm:function(){var e=this,t=this;t.$refs.passwordForm.validate(function(s){if(s){if(e.user.newPassword!=e.user.prePassword)return void e.showWarn("两次密码不一致");t.$request.doPost("/admin/sysUser/modifyPsd",t.user).then(function(e){e.isOk&&(t.dialog.open=!1,t.$emit("success"))})}})},showDialog:function(e,t){this.resetForm(this.$refs.sysUserForm),this.dialog.open=!0,this.dialog.title=e,this.dialog.disabled=t}}},o,!1,function(e){s("3iv/")},"data-v-eb64baa8",null);t.default=i.exports}});
//# sourceMappingURL=1.e68ab95f17b648b0f9b5.js.map